# Кейс интервью 

Приходит продакт кино и говорит, я знаю что в принципе оч популярный короткий контент и там часто люди смотрят нарезки из фильмов, может мы можем что-то похожее у себя сделать и залипали у нас. Что как аналитик будешь делать?

# Техсобес

## Python

1) Напиши функцию которая заменит каждый элемент списка произведением всех остальных элементов. Пример - [2, 3, 4] -> [12, 8, 6]

2) Пандас

```
import pandas as pd
 
data = {
    'Product': ['A', 'B', 'A', 'B', 'C', 'A', 'B', 'C'],
    'Sales': [100, 200, 150, 300, 100, 200, 250, 150],
    'Date': ['2021-01-01', '2021-02-01', '2022-03-01', '2022-04-01', '2023-01-01', '2023-02-01', '2023-03-01', '2023-04-01']
}
 
df = pd.DataFrame(data)
```

Написать функцию, которая добавляет новый столбец Year с годом продажи, а затем группирует данные по году и продукту, суммируя продажи. Возвращаемый результат должен быть DataFrame с индексами Year и Product, и столбцом - сумма продаж TotalSales."

## SQL

1) 

Дана таблица с событиями по смотрению контента (playback) вида
```
-- | user_id    | title_id  | play_dt     | play_duration |
-- |------------|-----------|-------------|---------------|
-- | 1          | 130       | 2022-08-10  | 120           |
-- | 1          | 150       | 2022-08-14  | 60            |
-- | 1          | 155       | 2022-08-14  | 90            |
-- | 2          | 121       | 2022-11-01  | 10            |
-- | 1          | 80        | 2023-01-10  | 1             |
-- | 1          | 176       | 2023-08-19  | 20            |
-- | 2          | 142       | 2023-06-17  | 80            |
-- | 3          | 200       | 2023-09-19  | 5             |
```

Найти для каждого месяца по топ-5 тайтлов, которые посомтрело больше всего человек

2) Таблица как в задании 1. Найти сколько юзеров смотрели тайтл c id 150 вчера, но не смотрели ничего как минимум 30 дней до этого

3) Если у нас есть таблица с контентом (content) вида
```
-- | title_id  | season_id | name                       |duration |content_type |
-- |-----------|-----------|----------------------------|---------|-------------|
-- | 130       | 130       | Матрица                    | 120     | movie       |
-- | 150       | 110       | Чикатило сезон 1. Серия 1. | 55      | episode     |
-- | 151       | 110       | Чикатило сезон 1. Серия 2. | 55      | episode     |
-- | 155       | 111       | Чикатило сезон 2. Серия 5  | 55      | episode     |
-- | 110       | 110       | Чикатило сезон 1.          |         | season      |
-- | 80        | 80        | Гарри Поттер 1             | 140     | movie       |
```
Сделать аналогичный топ как в 1 пункте, но серии сериалов нужно сгруппировать по сезонам, а фильмы оставить как есть + Добавить названия сезонов/фильмов

## Статистика 

1) Контент для онлайн-кинотеатра ОККО поступает от трех различных студий: 
Студия A производит 30% всех фильмов, 
Студия B – 55%, а Студия C – остальную часть.
Фильмы от Студии A имеют 1% вероятность того, что они будут иметь технические проблемы при воспроизведении, для Студии B этот показатель составляет 1,5%, а для Студии C – 2%. 

Пользователь выбрал для просмотра фильм, который оказался с техническими проблемами. Какова вероятность того, что этот фильм был произведен Студией B?

2) Когда нужны АА тесты ?
3) Какие методы снижения дисперсии есть?
4) Что такое бутстрап?
5) О чем надо подумать при дизайне тесте?


# Финал 

Какую бы North Start метрику ты предложил бы для ОККО? 